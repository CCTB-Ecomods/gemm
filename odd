1. Purpose

This model is designed to simulate several patterns across genetic, individual, population and (meta-)community levels.


2. Entities, state variable and scales

Individuals (plants or animals) are the basic entity in the model.
Each individual carries a diploid set of chromosomes, which in turn are comprised of genes.
Some of the genes code for on ore more traits (pleiotropy), while a trait can be dependent on more than one gene (polygene).
The realized trait value is the mean of the traits coded by maternal and paternal alleles.
Traits thus controlled encompass
the initial body mass (size) of offspring ("seedsize"),
the body mass determining onset of maturity and thus reproductive capability ("repsize"),
the groth rate ("growthrate"),
the probability for density-independent mortality ("ageprob"),
mean dispersal distance ("dispmean"),
the probability of dispersal ("dispprob"),
the shape of the dispersal kernel, controlling long-distance-dispersal ("dispshape"),
the probability and thus frequence of reproduction ("repprob"),
the radius in which an individual searches for a mate ("repradius"),
the mean number of offspring in a reproduction event (litter size,n "reprate"),
the threshold of sequence identity between mates determining genetic compatibility ("reptol"),
values representing the optimum and the tolerance (standard deviation) of a physical niche parameter ("tempopt", "temptol", resp.).
Alternatively to be controlled by mutable genes, these traits can also be set to fixed values.
Additionally, individuals carry attributes which describe their bodymass, their age and the combined effects of adaptation and life history (fitness).
Furthermore, every indivdual carries a marker which denotes whether a given individual has newly arrived to a patch/grid cell.

Every individual is placed inside an arena of grid cells or patches, each of which has a unique location (coordinates) and is characterized by physical properties
such as temperature and size (carrying capacity).
Over the course of the simulation these properties (location or physical parameters) might change, reflecting geomorphological dynamics.
All individuals within one patch constitute a community.

Processes and updates are repeated every timestep, while each timestep represent approximately one generation.

3. Process overview and scheduling

At the start of a simulation user defined parameters are read, containing also a definition of the simulation arena.
The initialisation step creates individuals with randomly chosen parameters and traits and deposits clones of one kind of indivudual ("species")
in one patch.
At the end of initialisation each patch holds several populations of clones.
In each timestep each individual in each patch will (in no particular order unless otherwise stated) undergo the following processes:
(a) establishment. When an individual is new to a patch (by recent birth or dispersal event), their physical niche preferences are compared with the actual niche properties of the present patch.
The individual fitness parameter is set according to the deviation from the optimum value considering the niche breadth as standard deviation of a gaussian curve.
[provide equation]
(b) competition. Individuals are sorted according to their body sizes (from small to large).
Starting with small individuals an individual will be removed from the local community with high probability (following a geometric distribution), if the sum of the community's bodymasses
exceed the available space.
Once total bodymass is below carrying capacity the procedure is finished.
(c) growth. An individual changes its size following the metabolic theory of ecology and an individual growth rate parameter.
[equation]
(d) Density independent mortality. An individual is removed from the local community with a certain probability that is specified within that individual's traits.
(e) reproduction. Given a individual probability ("repprob", modified by the fitness parameter) an individual decides on whether to reproduce.
In the case of reproduction and if the individual is larger or equal the individual's reproductive size, first the number of offspring is randomly drawn, following the individual's trait value and
the metabolic theory.
[equation]
Following the individuals reproductive radius possible partners in the vicinity (patches whose distances fall within the radius) are selected based on whether they share the same chromosome number with the
reproducing individual and whether the sequence identity between both individuals is equal or higher the reproducing individual's tolerance.
If a suitable partner is found sets of haploid chromosomes from the diploid sets of both individuals are drawn randomly, comprising the genome for the offspring.
At this point every position in the offspring's basecode may mutate with a given probability.
In the case of mutation all traits associated with the respective gene will randomly change value (normally distributed, with the standard deviation the quotient of the original value over a scaling constant).
The new individuals' trait values are then calculated as the means between maternal and paternal alleles and the individuals added to the community, marked as new and with their size set to the initial bodymass.
